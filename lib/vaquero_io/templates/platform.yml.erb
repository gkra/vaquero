platform:
  product: <%= @app_name %>
  provider: <%= name %>
  plugin_version: <%= version %>

  environments:
    -

  nodename:
    - environment
    - role

  infrastructure:
  <% providerfile['infrastructure'].each do |requiredfile| %>
    - <%= requiredfile %>
  <% end %>

  profiles:

    defaultprofile: &defaultprofile
    <% providerfile['infrastructure'].each do |requiredfile| %>
      <%= requiredfile %>:
    <% end %>
    <% providerfile['platform'].each do |k, v| %>
      <%= k %>:
      <% if v.first[0] == 'array' %>
        -
      <% end %>
      <% if v.first[0] == 'hash' %>
        <% v.first[1].each do |hk, hv| %>
          <%= hk %>:
          <% if hv.first[0] == 'array' %>
            -
          <% end %>
        <% end %>
      <% end %>
    <% end %>

  roles:

    example:
      <<: *defaultprofile